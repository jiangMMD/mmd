<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mmd.dao.PropnameDao">
    <select id="getAllProp" resultType="ProdSkupropname">
        SELECT
        n.prop_id,n.prop_name,
        (SELECT GROUP_CONCAT(prop_val) FROM prod_skupropval ps WHERE ps.prop_name_id = n.prop_id AND ps.recsts = '1') prop_val
        FROM
        prod_skupropname n
        <where> n.recsts = '1'
            <if test="propName !=null and propName!=''">
                and prop_name like CONCAT('%', #{propName}, '%')
            </if>
        </where>
    </select>

    <update id="updPropnameInfo" parameterType="ProdSkupropname">
        update prod_skupropname set prop_name = #{propName} where prop_id = #{propId}
    </update>

    <update id="delPropnameInfo">
        update prod_skupropname set recsts = 'D' where prop_id in <foreach collection="ids" item="id" open="(" close=")" separator=",">#{id}</foreach>
    </update>

    <select id="getPropByName" resultType="ProdSkupropname">
        SELECT prop_id, prop_name,recsts from prod_skupropname where (prop_name = #{propName})
    </select>

    <insert id="addPropnameInfo" parameterType="ProdSkupropname">
        INSERT INTO prod_skupropname(prop_name, recsts)
        VALUES (#{propName}, '1')
    </insert>

</mapper>